#!/usr/bin/env php
<?php

// Autoloader resolution for both development and installed contexts
foreach ([
    __DIR__ . '/../../../autoload.php',  // Installed as dependency
    __DIR__ . '/../vendor/autoload.php', // Development
] as $file) {
    if (file_exists($file)) {
        require $file;
        break;
    }
}

if (!class_exists('Symfony\Component\Console\Application')) {
    fwrite(STDERR, 'Composer autoloader not found. Run "composer install" first.' . PHP_EOL);
    exit(1);
}

use Faran\Pulsar\Commands\MakeActionCommand;
use Faran\Pulsar\Commands\MakeControllerCommand;
use Faran\Pulsar\Commands\MakeDtoCommand;
use Faran\Pulsar\Commands\MakeEnumCommand;
use Faran\Pulsar\Commands\MakeEventCommand;
use Faran\Pulsar\Commands\MakeExceptionCommand;
use Faran\Pulsar\Commands\MakeModelCommand;
use Faran\Pulsar\Commands\MakeOperationCommand;
use Faran\Pulsar\Commands\MakePolicyCommand;
use Faran\Pulsar\Commands\MakeQueryCommand;
use Faran\Pulsar\Commands\MakeRequestCommand;
use Faran\Pulsar\Commands\MakeServiceCommand;
use Faran\Pulsar\Commands\MakeUseCaseCommand;
use Faran\Pulsar\Commands\PingCommand;
use Faran\Pulsar\Commands\PublishContextCommand;
use Faran\Pulsar\Commands\PublishSkillCommand;
use Symfony\Component\Console\Application;

$app = new Application('Pulsar', '0.1.0');

// Utility commands
$app->addCommand(new PingCommand());

// Service layer commands
$app->addCommand(new MakeServiceCommand());
$app->addCommand(new MakeControllerCommand());
$app->addCommand(new MakeRequestCommand());
$app->addCommand(new MakeUseCaseCommand());
$app->addCommand(new MakeOperationCommand());

// Domain layer commands
$app->addCommand(new MakeModelCommand());
$app->addCommand(new MakeActionCommand());
$app->addCommand(new MakeDtoCommand());
$app->addCommand(new MakePolicyCommand());
$app->addCommand(new MakeEventCommand());
$app->addCommand(new MakeEnumCommand());
$app->addCommand(new MakeExceptionCommand());
$app->addCommand(new MakeQueryCommand());

// Publishing commands
$app->addCommand(new PublishContextCommand());
$app->addCommand(new PublishSkillCommand());

$app->run();
